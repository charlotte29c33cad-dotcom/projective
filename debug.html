<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>VK Game - Debug Mode</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        #debug-console {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 200px;
            background: rgba(0,0,0,0.95);
            color: #0f0;
            font-family: monospace;
            font-size: 11px;
            padding: 10px;
            overflow-y: auto;
            border-top: 2px solid #0f0;
            z-index: 10000;
        }
        #debug-console div { margin: 2px 0; }
        .log-error { color: #f00; }
        .log-warn { color: #ff0; }
        .log-info { color: #0ff; }
    </style>
</head>
<body>
    <div id="app">
        <div id="game-container">
            <canvas id="gameCanvas"></canvas>
            <div id="score">–°—á—ë—Ç: 0</div>
            <div id="debug-panel" style="position: absolute; bottom: 220px; left: 10px; background: rgba(0,0,0,0.8); color: #0f0; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px; z-index: 1000; display: block;">
                <div>localStorage: <span id="ls-status">?</span></div>
                <div>Last save: <span id="last-save">never</span></div>
                <div>Level: <span id="debug-level">?</span></div>
                <button onclick="saveProgress()" style="margin-top: 5px; padding: 5px 10px;">üíæ Save Now</button>
                <button onclick="syncNow()" style="margin-top: 5px; padding: 5px 10px;">‚òÅÔ∏è Sync Now</button>
                <button onclick="location.reload()" style="margin-top: 5px; padding: 5px 10px;">üîÑ Reload</button>
                <button onclick="clearProgress()" style="margin-top: 5px; padding: 5px 10px;">üóëÔ∏è Clear</button>
            </div>
        </div>
    </div>
    
    <div id="debug-console"></div>

    <script>
        // Intercept console.log/warn/error and display on page
        const debugConsole = document.getElementById('debug-console');
        const originalLog = console.log;
        const originalWarn = console.warn;
        const originalError = console.error;
        
        function addToConsole(msg, type = 'log') {
            const div = document.createElement('div');
            div.className = 'log-' + type;
            div.textContent = new Date().toLocaleTimeString() + ' [' + type.toUpperCase() + '] ' + msg;
            debugConsole.appendChild(div);
            debugConsole.scrollTop = debugConsole.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToConsole(args.map(a => typeof a === 'object' ? JSON.stringify(a) : String(a)).join(' '), 'info');
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToConsole(args.map(a => typeof a === 'object' ? JSON.stringify(a) : String(a)).join(' '), 'warn');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToConsole(args.map(a => typeof a === 'object' ? JSON.stringify(a) : String(a)).join(' '), 'error');
        };
        
        window.addEventListener('error', (e) => {
            addToConsole('UNHANDLED ERROR: ' + e.message + ' at ' + e.filename + ':' + e.lineno, 'error');
        });
        
        console.log('Debug console initialized');
    </script>

    <!-- VK Bridge SDK -->
    <script src="https://unpkg.com/@vkontakte/vk-bridge/dist/browser.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    
    <!-- Game Scripts -->
    <script src="game.js"></script>
</body>
</html>
